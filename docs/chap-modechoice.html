<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Mode and Destination Choice | Urban Transportation Planning</title>
  <meta name="description" content="These are notes and assignments related to the Urban Transportation Planning class at BYU." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Mode and Destination Choice | Urban Transportation Planning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are notes and assignments related to the Urban Transportation Planning class at BYU." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Mode and Destination Choice | Urban Transportation Planning" />
  
  <meta name="twitter:description" content="These are notes and assignments related to the Urban Transportation Planning class at BYU." />
  

<meta name="author" content="Gregory Macfarlane, PhD, PE" />


<meta name="date" content="2021-10-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap-distribution.html"/>
<link rel="next" href="chap-assignment.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Urban Transportation Planning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Foreword</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap-blocks.html"><a href="chap-blocks.html"><i class="fa fa-check"></i><b>1</b> Building Blocks</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chap-blocks.html"><a href="chap-blocks.html#planning-for-human-systems"><i class="fa fa-check"></i><b>1.1</b> Planning for Human Systems</a></li>
<li class="chapter" data-level="1.2" data-path="chap-blocks.html"><a href="chap-blocks.html#the-four-step-transportation-planning-process"><i class="fa fa-check"></i><b>1.2</b> The Four-Step Transportation Planning Process</a></li>
<li class="chapter" data-level="1.3" data-path="chap-blocks.html"><a href="chap-blocks.html#travel-model-building-blocks"><i class="fa fa-check"></i><b>1.3</b> Travel Model Building Blocks</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="chap-blocks.html"><a href="chap-blocks.html#travel-analysis-zones-and-se-data"><i class="fa fa-check"></i><b>1.3.1</b> Travel Analysis Zones and SE Data</a></li>
<li class="chapter" data-level="1.3.2" data-path="chap-blocks.html"><a href="chap-blocks.html#transportation-networks"><i class="fa fa-check"></i><b>1.3.2</b> Transportation Networks</a></li>
<li class="chapter" data-level="1.3.3" data-path="chap-blocks.html"><a href="chap-blocks.html#matrices"><i class="fa fa-check"></i><b>1.3.3</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chap-blocks.html"><a href="chap-blocks.html#data-inputs"><i class="fa fa-check"></i><b>1.4</b> Data Inputs</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="chap-blocks.html"><a href="chap-blocks.html#household-travel-surveys"><i class="fa fa-check"></i><b>1.4.1</b> Household Travel Surveys</a></li>
<li class="chapter" data-level="1.4.2" data-path="chap-blocks.html"><a href="chap-blocks.html#us-census-bureau"><i class="fa fa-check"></i><b>1.4.2</b> US Census Bureau</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="chap-blocks.html"><a href="chap-blocks.html#statistical-and-mathematical-techniques"><i class="fa fa-check"></i><b>1.5</b> Statistical and Mathematical Techniques</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="chap-blocks.html"><a href="chap-blocks.html#continuous-and-discrete-distributions"><i class="fa fa-check"></i><b>1.5.1</b> Continuous and Discrete Distributions</a></li>
<li class="chapter" data-level="1.5.2" data-path="chap-blocks.html"><a href="chap-blocks.html#ipf"><i class="fa fa-check"></i><b>1.5.2</b> Iterative Proportional Fitting</a></li>
<li class="chapter" data-level="1.5.3" data-path="chap-blocks.html"><a href="chap-blocks.html#regression-analysis"><i class="fa fa-check"></i><b>1.5.3</b> Regression Analysis</a></li>
<li class="chapter" data-level="1.5.4" data-path="chap-blocks.html"><a href="chap-blocks.html#numerical-optimization"><i class="fa fa-check"></i><b>1.5.4</b> Numerical Optimization</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chap-blocks.html"><a href="chap-blocks.html#hw-blocks"><i class="fa fa-check"></i>Homework</a></li>
<li class="chapter" data-level="" data-path="chap-blocks.html"><a href="chap-blocks.html#lab-blocks"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="chap-blocks.html"><a href="chap-blocks.html#marginal-distributions"><i class="fa fa-check"></i>Marginal Distributions</a></li>
<li class="chapter" data-level="" data-path="chap-blocks.html"><a href="chap-blocks.html#joint-distribution"><i class="fa fa-check"></i>Joint Distribution</a></li>
<li class="chapter" data-level="" data-path="chap-blocks.html"><a href="chap-blocks.html#report"><i class="fa fa-check"></i>Report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-tripgen.html"><a href="chap-tripgen.html"><i class="fa fa-check"></i><b>2</b> Trip Generation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap-tripgen.html"><a href="chap-tripgen.html#trip-production"><i class="fa fa-check"></i><b>2.1</b> Trip Production</a></li>
<li class="chapter" data-level="2.2" data-path="chap-tripgen.html"><a href="chap-tripgen.html#trip-attraction"><i class="fa fa-check"></i><b>2.2</b> Trip Attraction</a></li>
<li class="chapter" data-level="" data-path="chap-tripgen.html"><a href="chap-tripgen.html#hw-generation"><i class="fa fa-check"></i>Homework</a></li>
<li class="chapter" data-level="" data-path="chap-tripgen.html"><a href="chap-tripgen.html#lab-generation"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chap-tripgen.html"><a href="chap-tripgen.html#trip-production-1"><i class="fa fa-check"></i><b>2.2.1</b> Trip Production</a></li>
<li class="chapter" data-level="2.2.2" data-path="chap-tripgen.html"><a href="chap-tripgen.html#trip-attraction-1"><i class="fa fa-check"></i><b>2.2.2</b> Trip Attraction</a></li>
<li class="chapter" data-level="2.2.3" data-path="chap-tripgen.html"><a href="chap-tripgen.html#report-1"><i class="fa fa-check"></i><b>2.2.3</b> Report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-distribution.html"><a href="chap-distribution.html"><i class="fa fa-check"></i><b>3</b> Trip Distribution</a>
<ul>
<li class="chapter" data-level="" data-path="chap-distribution.html"><a href="chap-distribution.html#hw-distribution"><i class="fa fa-check"></i>Homework</a>
<ul>
<li class="chapter" data-level="" data-path="chap-distribution.html"><a href="chap-distribution.html#first-problem-gravity-model-development"><i class="fa fa-check"></i>First Problem: Gravity Model Development</a></li>
<li class="chapter" data-level="" data-path="chap-distribution.html"><a href="chap-distribution.html#second-problem-model-calibration"><i class="fa fa-check"></i>Second Problem: Model Calibration</a></li>
<li class="chapter" data-level="" data-path="chap-distribution.html"><a href="chap-distribution.html#third-problem-model-application"><i class="fa fa-check"></i>Third Problem: Model Application</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-modechoice.html"><a href="chap-modechoice.html"><i class="fa fa-check"></i><b>4</b> Mode and Destination Choice</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap-modechoice.html"><a href="chap-modechoice.html#mathematical-derivation"><i class="fa fa-check"></i><b>4.1</b> Mathematical Derivation</a></li>
<li class="chapter" data-level="4.2" data-path="chap-modechoice.html"><a href="chap-modechoice.html#utility-equations"><i class="fa fa-check"></i><b>4.2</b> Utility Equations</a></li>
<li class="chapter" data-level="4.3" data-path="chap-modechoice.html"><a href="chap-modechoice.html#mnl-estimation"><i class="fa fa-check"></i><b>4.3</b> MNL Estimation</a></li>
<li class="chapter" data-level="4.4" data-path="chap-modechoice.html"><a href="chap-modechoice.html#iia-and-nested-logit"><i class="fa fa-check"></i><b>4.4</b> IIA and Nested Logit</a></li>
<li class="chapter" data-level="4.5" data-path="chap-modechoice.html"><a href="chap-modechoice.html#accessibility-and-log-sums"><i class="fa fa-check"></i><b>4.5</b> Accessibility and Log Sums</a></li>
<li class="chapter" data-level="4.6" data-path="chap-modechoice.html"><a href="chap-modechoice.html#destination-choice"><i class="fa fa-check"></i><b>4.6</b> Destination Choice</a></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#hw-modechoice"><i class="fa fa-check"></i>Homework</a>
<ul>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#first-problem-set-multinomial-logit-model-estimation"><i class="fa fa-check"></i>First Problem Set: Multinomial Logit Model Estimation</a></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#second-problem-set-nested-logit-models"><i class="fa fa-check"></i>Second Problem Set: Nested Logit Models</a></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#third-problem-set-log-sums-and-destination-choice"><i class="fa fa-check"></i>Third Problem Set: Log Sums and Destination Choice</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#lab"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#mode-choice-calibration"><i class="fa fa-check"></i>Mode Choice Calibration</a></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#destination-choice-calibration"><i class="fa fa-check"></i>Destination Choice Calibration</a></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#report-2"><i class="fa fa-check"></i>Report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-assignment.html"><a href="chap-assignment.html"><i class="fa fa-check"></i><b>5</b> Network Assignment and Validation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap-assignment.html"><a href="chap-assignment.html#volume---delay-functions"><i class="fa fa-check"></i><b>5.1</b> Volume - Delay Functions</a></li>
<li class="chapter" data-level="5.2" data-path="chap-assignment.html"><a href="chap-assignment.html#assignment-algorithms"><i class="fa fa-check"></i><b>5.2</b> Assignment Algorithms</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chap-assignment.html"><a href="chap-assignment.html#all-or-nothing"><i class="fa fa-check"></i><b>5.2.1</b> All-or-Nothing</a></li>
<li class="chapter" data-level="5.2.2" data-path="chap-assignment.html"><a href="chap-assignment.html#incremental-assignment"><i class="fa fa-check"></i><b>5.2.2</b> Incremental Assignment</a></li>
<li class="chapter" data-level="5.2.3" data-path="chap-assignment.html"><a href="chap-assignment.html#successive-averages-fhwa-assignment"><i class="fa fa-check"></i><b>5.2.3</b> Successive Averages (FHWA) Assignment</a></li>
<li class="chapter" data-level="5.2.4" data-path="chap-assignment.html"><a href="chap-assignment.html#frank-wolfe"><i class="fa fa-check"></i><b>5.2.4</b> Frank-Wolfe</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chap-assignment.html"><a href="chap-assignment.html#hw-assignment"><i class="fa fa-check"></i>Homework</a></li>
<li class="chapter" data-level="" data-path="chap-assignment.html"><a href="chap-assignment.html#laboratory-assignment"><i class="fa fa-check"></i>Laboratory Assignment</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap-process.html"><a href="chap-process.html"><i class="fa fa-check"></i><b>6</b> The Planning Process</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="app-demomodel.html"><a href="app-demomodel.html"><i class="fa fa-check"></i><b>A</b> Demonstration Model</a>
<ul>
<li class="chapter" data-level="A.1" data-path="app-demomodel.html"><a href="app-demomodel.html#running-the-model"><i class="fa fa-check"></i><b>A.1</b> Running the Model</a></li>
<li class="chapter" data-level="A.2" data-path="app-demomodel.html"><a href="app-demomodel.html#files-and-reports"><i class="fa fa-check"></i><b>A.2</b> Files and Reports</a></li>
<li class="chapter" data-level="A.3" data-path="app-demomodel.html"><a href="app-demomodel.html#writing-custom-scripts"><i class="fa fa-check"></i><b>A.3</b> Writing Custom Scripts</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="app-demomodel.html"><a href="app-demomodel.html#network-bandwidth"><i class="fa fa-check"></i><b>A.3.1</b> Network Bandwidth</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="app-demomodel.html"><a href="app-demomodel.html#network-and-zone-maps"><i class="fa fa-check"></i><b>A.4</b> Network and Zone Maps</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="app-demomodel.html"><a href="app-demomodel.html#shortest-paths"><i class="fa fa-check"></i><b>A.4.1</b> Shortest Paths</a></li>
<li class="chapter" data-level="A.4.2" data-path="app-demomodel.html"><a href="app-demomodel.html#mode-choice-logsum-maps"><i class="fa fa-check"></i><b>A.4.2</b> Mode Choice Logsum Maps</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="app-demomodel.html"><a href="app-demomodel.html#editing-transit-lines"><i class="fa fa-check"></i><b>A.5</b> Editing Transit Lines</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="app-rstudio.html"><a href="app-rstudio.html"><i class="fa fa-check"></i><b>B</b> R and RStudio Help</a>
<ul>
<li class="chapter" data-level="B.1" data-path="app-rstudio.html"><a href="app-rstudio.html#installing"><i class="fa fa-check"></i><b>B.1</b> Installing</a></li>
<li class="chapter" data-level="B.2" data-path="app-rstudio.html"><a href="app-rstudio.html#rstudio-orientation"><i class="fa fa-check"></i><b>B.2</b> RStudio Orientation</a></li>
<li class="chapter" data-level="B.3" data-path="app-rstudio.html"><a href="app-rstudio.html#r-packages"><i class="fa fa-check"></i><b>B.3</b> R Packages</a></li>
<li class="chapter" data-level="B.4" data-path="app-rstudio.html"><a href="app-rstudio.html#working-with-tables"><i class="fa fa-check"></i><b>B.4</b> Working with Tables</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="app-rstudio.html"><a href="app-rstudio.html#reading-data"><i class="fa fa-check"></i><b>B.4.1</b> Reading Data</a></li>
<li class="chapter" data-level="B.4.2" data-path="app-rstudio.html"><a href="app-rstudio.html#modifying-and-summarizing-tables"><i class="fa fa-check"></i><b>B.4.2</b> Modifying and Summarizing Tables</a></li>
<li class="chapter" data-level="B.4.3" data-path="app-rstudio.html"><a href="app-rstudio.html#app-mutate"><i class="fa fa-check"></i><b>B.4.3</b> Mutate, Summarize, and Group</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="app-rstudio.html"><a href="app-rstudio.html#graphics-with-ggplot2"><i class="fa fa-check"></i><b>B.5</b> Graphics with <code>ggplot2</code></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Urban Transportation Planning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap-modechoice" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Mode and Destination Choice</h1>
<p>Assume that person has a set of mode choices in front of them. They could
pick to drive, walk, take transit, or some combination of those. Which one they
pick for which kind of trip is not a simple question, but travel models need
a mathematical way to represent this choice.</p>
<div id="mathematical-derivation" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Mathematical Derivation</h2>
<p>We’ll say that person <span class="math inline">\(n\)</span> is choosing between alternatives <span class="math inline">\(i, j, \ldots \in J\)</span>.
In economic theory, people pick the alternative that brings them the most
<em>utility</em>, <span class="math inline">\(U\)</span>. So person <span class="math inline">\(n\)</span> will choose <span class="math inline">\(i\)</span> if <span class="math inline">\(U_i&gt;U_j, \forall j \neq i \in J\)</span>.
The problem we face is that <span class="math inline">\(U\)</span> contains things we can measure and model (like the
travel time and the fare) as well as things we can’t (like how much this person
hates riding the bus). So really <span class="math inline">\(U_i\)</span> has two parts: a measurable portion <span class="math inline">\(V_i\)</span>
and an unmeasurable portion <span class="math inline">\(\varepsilon_i\)</span>.</p>
<p><span class="math display" id="eq:uve">\[\begin{equation}
  U_i = V_i + \varepsilon_i
  \tag{4.1}
\end{equation}\]</span></p>
<p>So in our model, people will choose <span class="math inline">\(i\)</span> if</p>
<p><span class="math display">\[\begin{align*}
V_i + \varepsilon_i &amp;&gt; V_j + \varepsilon_j, \forall j \neq i \in J\\
V_i - V_j &amp;&gt; \varepsilon_j - \varepsilon_i, \forall j \neq i \in J\\
\end{align*}\]</span></p>
<p>or, if the difference in observed utility is greater than the difference in the
unobserved error. Because this difference in error is unobserved, we can treat
it as a random variable with an assumed distribution. If we make a particular
assumption<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>, then the <em>probability</em> that person <span class="math inline">\(n\)</span> chooses option <span class="math inline">\(i\)</span> is</p>
<p><span class="math display" id="eq:mnl">\[\begin{equation}
  P_n(i | V_i, V_j \forall j \neq i \in J) = \frac{e^{V_i}}{\sum_{j\in J} e^{V_j}}
  \tag{4.2}
\end{equation}\]</span></p>
<p>There are two important things to note that result from this derivation:</p>
<ol style="list-style-type: decimal">
<li>Only the differences in Utility matter. This will have a number of implications
for the interpretation and use of the model.</li>
<li>The model formula depends entirely on the assumed distribution of the unobserved
utility. If that assumption isn’t met (and it usually isn’t!) a different model
is needed.</li>
</ol>
</div>
<div id="utility-equations" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Utility Equations</h2>
<p>The observed utility usually takes a linear form, <span class="math inline">\(V_i = \alpha_i + X_i\beta\)</span>. This
means that each alternative will have a linear equation,</p>
<p><span class="math display">\[\begin{align*}
V_{\text{Auto}}  =&amp;  - 0.05(\text{time}_a)  - 0.3(\text{cost}_a)\\
V_{\text{Bus}}  =&amp; -4.5 - 0.05(\text{time}_b)  - 0.3(\text{cost}_b) - 1.4(\text{high income})\\   
V_{\text{Walk}}  =&amp; -6.0 - 0.05(\text{time}_w)  - 0.3(\text{cost}_w) - 1.8(\text{high income})\\   
\end{align*}\]</span></p>
<p>Recall that only the difference in the utility matters, which we showed theoretically above.
you can also see it numerically because <span class="math inline">\(e^0 / (e^1 + e^0) = e^1 / (e^2 + e^1) = 0.269\)</span>.
So the utility equations have to reflect this difference in the way that they get
structured. There are three basic basic values that show up in these equations,
and the difference between them is how they create and use difference in the
utility:</p>
<ul>
<li><em>Alternative-Specific Constants</em>: These function like intercepts in a
linear regression model. The constants control for the observed difference
between alternatives resulting from the unobserved utility; if all else is
equal, the constants describe what the utility of each mode will be. One
alternative is selected as the <em>reference alternative</em>, with <span class="math inline">\(\alpha = 0\)</span>.</li>
<li><em>Generic Coefficients</em>: These coefficients have a single estimated
parameter. That is, the <span class="math inline">\(\hat{\beta}\)</span> coefficient for these variables has the
same value in the utility equation for every alternative. These estimates come
from variables that vary naturally across the alternatives, like the cost of
travel.</li>
<li><em>Alternative-Specific Coefficient</em>: This type of coefficient has a unique
estimate for each alternative. That is, <span class="math inline">\(\hat{\beta}_{DA}\)</span> is different from
<span class="math inline">\(\hat{\beta}_{Walk}\)</span>. This type of estimate comes from variables that are
constant across alternatives, like the distance of the trip.</li>
</ul>
</div>
<div id="mnl-estimation" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> MNL Estimation</h2>
<p>Ordinary Least Squares does not work on multinomial logit models, so we need
another way of estimating the model coefficients. We instead use a numerical
procedure called <em>maximum likelihood estimation</em>.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p>
<p>The utility equation is <span class="math inline">\(V_i = \alpha_i + X_i\beta\)</span>. We want to find an estimate
<span class="math inline">\(\hat\beta\)</span> that are <em>most likely</em> given the observed data. For one person,
the probability that our model picks an alternative <span class="math inline">\(i\)</span> is given by the MNL
formula in Equation <a href="chap-modechoice.html#eq:mnl">(4.2)</a>. Let’s simplify this to a function of <span class="math inline">\(\beta\)</span>,
<span class="math inline">\(P_{in}(\beta)\)</span>. We want to pick the value of <span class="math inline">\(\beta\)</span> that gives a high probability
to the chosen alternative and low probability to the non-chosen alternatives.
Let’s create a power value <span class="math inline">\(\delta_{in}\)</span> equal to 1 if chosen and zero if not.
The likelihood of our model for one alternative is therefore</p>
<p><span class="math display" id="eq:likelihood">\[\begin{equation}
\mathcal{L} = P_{in}(\beta)^{\delta_{in}}
  \tag{4.3}
\end{equation}\]</span></p>
<p>But we want to find values that maximize this likelihood for <em>all</em> alternatives
for <em>all</em> people. Recall from basic statistics that the probability of multiple
independent events occuring simultaneously is the product of the probabilities
of each event. So the likelihood equation for our entire dataset is</p>
<p><span class="math display">\[\begin{equation*}
\mathcal{L} = \prod_{n=1}^N \prod_{i \in J} P_{in}(\beta)^{\delta_{in}}
\end{equation*}\]</span></p>
<p>We encounter a problem here where each <span class="math inline">\(P_{in}\)</span> is going to be a number much
smaller than 1. If we multiply too many of these numbers together, our computer
won’t be able to keep track of a number that small. So we instead use the
logarithm of the likelihood function which turns products into sums,</p>
<p><span class="math display" id="eq:loglikelihood">\[\begin{equation}
\log(\mathcal{L}) = \sum_{n=1}^N \sum_{i \in J} \delta_{in} \log(P_{in}(\beta))
  \tag{4.4}
\end{equation}\]</span></p>
<p>We can also compare the log-likelihood of our estimated model
<span class="math inline">\(\log\mathcal{L}(\beta)\)</span> against the log-likelihood of some reference models to create
a statistic that works <em>kind of</em> like <span class="math inline">\(R^2\)</span> in a linear regression model.</p>
<p>First, imagine that we have a perfect model. That would mean the <span class="math inline">\(P_{in} = 1\)</span> for
the chosen alternative and zero for the others. The log-likelihood of this model
is</p>
<p><span class="math display">\[\begin{align*}
\log\mathcal{L}(*) &amp;= \sum_{n=1}^N  \log(1)\\
   &amp;= \sum_{n=1}^N  0\\
\end{align*}\]</span></p>
<p>Now, what happens if we have a model that is literally no better than random
chance? This could be called a <em>null model</em> where each option has equal probability.
That would also imply that every utility value is exactly the same,</p>
<p><span class="math display">\[\begin{align*}
\log\mathcal{L}(0) &amp;= \sum_{n=1}^N \sum_{i \in J} \delta_{in} \log(\frac{e^0}{\sum_J e^0})\\
 &amp;= \sum_{n=1}^N  \log(\frac{1}{J})\\
 &amp;= N \log(\frac{1}{J})\\
\end{align*}\]</span></p>
<p>This value depends on the number of observations and alternatives in the data
set, and so will be different for each problem. But because the logarithm of
a fraction is a negative number, <span class="math inline">\(\log\mathcal{L}(0)\)</span> will be a large negative
number.</p>
<p>The last special likelihood is what would happen if we just used the observed
choice probabilities, or the <em>market shares</em>. This is equivalent to a model
estimated with only the constants and no other variables included.</p>
<p><span class="math display">\[\begin{align*}
\log\mathcal{L}(C) &amp;= \sum_{n=1}^N \sum_{i \in J} \delta_{in} \log(\frac{e^\alpha}{\sum_J e^\alpha})\\
 &amp;= \sum_{n=1}^N  \sum_{i \in J} \log(P_i)\\
 &amp;= N_i \sum_{i \in J} \log(P_i)\\
\end{align*}\]</span></p>
<p>We can create a measure of goodness-of-fit using these measures. Let’s call it
<span class="math inline">\(\rho^2\)</span>. Let’s consider how much more likely our estimated model is than the null
model:</p>
<p><span class="math display" id="eq:rhonull">\[\begin{equation}
  \rho_0^2 = 1 - \frac{\log\mathcal{L}(\beta)}{\log\mathcal{L}(0)}
  \tag{4.5}
\end{equation}\]</span></p>
<p>If our model is no better than random chance, then <span class="math inline">\(\rho_0^2 = 0\)</span>. If our model
is perfect (log-likelihood of zero), then <span class="math inline">\(\rho_0^2 = 1\)</span>. In practice, you will
not ever see <span class="math inline">\(\rho_0^2\)</span> values anywhere near 1. You can build an analogous
<span class="math inline">\(\rho_C^2\)</span> metric by using the market shares likelihood as a reference.</p>
</div>
<div id="iia-and-nested-logit" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> IIA and Nested Logit</h2>
<p>The MNL model has a property referred to as the
<strong>independence of irrelevant alternatives</strong> (IIA). This simply means that the
ratio of the probabilities of two alternatives is only based on the utility of
those two alternatives. Mathematically,</p>
<p><span class="math display" id="eq:iia">\[\begin{equation}
 \frac{P_i}{P_k} = 
   \frac{e^{V_i}}{\sum_{j\in J} e^{V_j}} \times 
   \frac{\sum_{j\in J} e^{V_j}}{} = \frac{e^{V_i}}{e^{V_k}}
  \tag{4.6}
\end{equation}\]</span></p>
<p>This property plays an important role in mode choice, because it introduces
some unreasonable behavior when we add a new mode. Consider if we have two
modes, car and bus, with utilities of <span class="math inline">\(V_{bus} = 0\)</span> and <span class="math inline">\(V_{car} = 1\)</span>. The
choice probabilities of these two modes are</p>
<p><span class="math display">\[\begin{align*}
  P_{car} &amp;= \frac{exp(1)}{exp(0) + exp(1)} &amp;= 0.731\\
  P_{bus} &amp;= \frac{exp(0)}{exp(0) + exp(1)} &amp;= 0.269\\
  \frac{P_{car} }{P_{bus}} &amp;= 0.368  &amp;
\end{align*}\]</span></p>
<p>Now imagine add a light rail alternative to this scenario, with <span class="math inline">\(V_{LRT} = 0.5\)</span>.
The choice probabilities are now</p>
<p><span class="math display">\[\begin{align*}
  P_{car} &amp;= \frac{exp(1)  }{exp(0) + exp(1) + exp(0.5)} &amp;= 0.506\\
  P_{bus} &amp;= \frac{exp(0)  }{exp(0) + exp(1) + exp(0.5)} &amp;= 0.186\\
  P_{LRT} &amp;= \frac{exp(0.5)}{exp(0) + exp(1) + exp(0.5)} &amp;= 0.307\\
  \frac{P_{car} }{P_{bus}} &amp; = 0.368 &amp;
\end{align*}\]</span></p>
<p>The <em>ratio</em> of the choice probabilities of car and bus stay exactly the same.
A consequence of this is that 73% of the new light rail passengers were
formerly automobile passengers. But this doesn’t makes intuitive sense; we would
expect light rail and bus to have more unobserved things in common. Surely,
some automobile riders will decide to take transit when there is a light rail
instead of just a bus, but not <em>most</em> of the new light rail riders to be
converts. So we need a way to represent the fact that some alternatives are
“closer” to other alternatives.</p>
<p>When we derived the MNL, we assumed that the unobserved error <span class="math inline">\(\varepsilon_i\)</span>
was distributed independently. That is, if we were to make a matrix of the
correlation of the error between our three alternatives for car, bus, and LRT,
it would be the matrix below:</p>
<p><span class="math display">\[\begin{equation*}
\varepsilon  \sim
\begin{matrix}
1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 1\\
\end{matrix}

\end{equation*}\]</span></p>
<p>But what is more likely is that the two alternatives for bus and LRT have correlated
error terms, or the correlation between them is somewhere between 0 and 1. Let’s
assume that there is instead some coefficient that dictates the degree to which
these error terms are allowed to be correlated.</p>
<p><span class="math display">\[\begin{equation*}
\varepsilon  \sim
\begin{matrix}
1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; \lambda_{transit}\\
0 &amp; 1 - \lambda_{transit} &amp; 1\\
\end{matrix}
\end{equation*}\]</span></p>
<p>This is equivalent to saying that the choice of mode doesn’t look like an
equal choice among three alternatives,</p>
<p><img src="04_modechoice_files/figure-html/unnamed-chunk-1-1.png" width="30%" style="display: block; margin: auto;" /></p>
<p>But instead a two-stage choice, where people first choose whether they will take
transit, and then which transit mode they will choose.</p>
<p><img src="04_modechoice_files/figure-html/unnamed-chunk-2-1.png" width="30%" style="display: block; margin: auto;" /></p>
<p>This results in a <strong>nested logit model</strong>. The choice probability of an alternative
in this model is now</p>
<p><span class="math display" id="eq:nestedlogit">\[\begin{equation}
  P_{i} = \frac{e^{V_i/\lambda_k}(\lambda_{j \in B_{k}} e^{V_j/\lambda_k})^{\lambda_l - 1}}
  {\sum_{l\in K}(\sum_{j \in B_l} e^{V_j/\lambda_l})^{\lambda_l - 1}}
  \tag{4.7}
\end{equation}\]</span></p>
<p>It is important to note that if the estimated <span class="math inline">\(\lambda\)</span> value equals one, then
there is no observable correlation between the error terms, and the model reduces
to the MNL. If <span class="math inline">\(\lambda&gt;1\)</span>, then it implies <em>negative</em> correlation between the
alternatives. This violates utility theory, because it would cause <em>more</em>
people to choose auto when the utility of a transit mode increases. So valid
values for the estimated correlation are <span class="math inline">\(0 &lt; \lambda &lt; 1\)</span>.</p>
</div>
<div id="accessibility-and-log-sums" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Accessibility and Log Sums</h2>
</div>
<div id="destination-choice" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Destination Choice</h2>
</div>
<div id="hw-modechoice" class="section level2 unnumbered">
<h2>Homework</h2>
<p>In this unit’s assignment, you will use data from the 2000 Bay Area Travel
Survey to estimate multinomial and nested logit models that predict mode choice for work
trips. The data is available on <a href="https://byu.box.com/shared/static/ftzy74uaug0voet2wvwhgicxamhgcvp7.rds">on Box</a>. The data
are named as <code>worktrips_dfidx.rds</code>. You will also need to load the
<code>mlogit</code> library package, which contains the tools necessary to estimate
multinomial logit models.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="chap-modechoice.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlogit)</span>
<span id="cb96-2"><a href="chap-modechoice.html#cb96-2" aria-hidden="true" tabindex="-1"></a>worktrips <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&quot;data/worktrips_dfidx.rds&quot;</span>)</span></code></pre></div>
<p>Because multinomial logit models are so different from other models,
the data are stored in a special type of data frame. You can see the first several
rows of this data below; Person 1 in household 2 has five alternatives, and they
chose to drive alone. Person 3 chose to take transit.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="chap-modechoice.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(worktrips[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>], <span class="at">n=</span><span class="dv">12</span>)</span></code></pre></div>
<pre><code>##                  HHID PERID CASE       ALTNUM NUMALTS CHOSEN  IVTT OVTT
## 2-1. Drive Alone    2     1    1  Drive Alone       5   TRUE 13.38  2.0
## 2-1. Share 2        2     1    1      Share 2       5  FALSE 18.38  2.0
## 2-1. Share 3+       2     1    1     Share 3+       5  FALSE 20.38  2.0
## 2-1. Transit        2     1    1      Transit       5  FALSE 25.90 15.2
## 2-1. Bike           2     1    1         Bike       5  FALSE 40.50  2.0
## 3-1. Drive Alone    3     1    2  Drive Alone       5  FALSE 29.92 10.0
## 3-1. Share 2        3     1    2      Share 2       5  FALSE 34.92 10.0
## 3-1. Share 3+       3     1    2     Share 3+       5  FALSE 21.92 10.0
## 3-1. Transit        3     1    2      Transit       5   TRUE 22.96 14.2
## 3-1. Bike           3     1    2         Bike       5  FALSE 58.95 10.0
## 5-1. Drive Alone    5     1    3  Drive Alone       4   TRUE  8.60  6.0
## 5-1. Share 2        5     1    3      Share 2       4  FALSE 13.60  6.0</code></pre>
<p>In the first section, you will estimate a multinomial logit mode choice model
for work trips using the data collected in the San Francisco Bay. Then, you will
calculate nested logit models on the same data set. In the third step, you will
calculate mode choice model log sums and estimate a destination choice model.</p>
<div id="first-problem-set-multinomial-logit-model-estimation" class="section level3 unnumbered">
<h3>First Problem Set: Multinomial Logit Model Estimation</h3>
<p>To do this, use the <code>mlogit()</code> function, in a manner sort of like you
would use the <code>lm()</code> command. One thing to look out for: the difference between
generic and alternative-specific variables, described above.
To specify the model, we use the following construction.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="chap-modechoice.html#cb99-1" aria-hidden="true" tabindex="-1"></a>fit.mnl <span class="ot">&lt;-</span> <span class="fu">mlogit</span> ( CHOSEN <span class="sc">~</span> Generic <span class="sc">|</span> Alt.Specific, <span class="at">data =</span> worktrips )</span></code></pre></div>
<p>To examine the model output, the standard <code>summary()</code> command will produce a
coefficients table and key test statistics. The <code>modelsummary</code>
packages will produce convenient model comparison tables that can be included in
a report or pasted into Excel for further formatting. For your homework, please
include a formatted model comparison table rather than a print out of each model
summary.</p>
<p>Question 1: Calculate the likelihood of a model with no covariates
(equal-shares) and a model with constants only (market shares). Estimate a model
with only the travel time, and calculate the <span class="math inline">\(\rho^2\)</span> statistics
with respect to the equal shares model and the market shares model. Which
statistic is reported by the <code>summary()</code> command? Why is this important?</p>
<p>Question 2: Estimate a model with just the total travel time
(<code>TVTT</code>) and the cost of the trip (<code>COST</code>). These two parameter estimates will
allow you to calculate the value of time for the sample population as</p>
<p><span class="math display">\[VOT = \frac{60\hat{\beta}_{TVTT}}{100 \hat{\beta}_{COST}}\]</span></p>
<p>Report the value of time you calculate. Is this reasonable?</p>
<p>Question 3: Estimate a model with the out-of-vehicle travel
time (<code>OVTT</code>), and the in-vehicle travel time (<code>IVTT</code>). What is the
ratio of these parameters? What does this tell you about how people feel waiting
for the bus?</p>
<p>Question 4: Estimate a model with the residential population density
(<code>RSPOPDEN</code>) and the workplace employment density (<code>WKEMPDEN</code>), controlling for
the affordability of the trip (<code>COSTINC</code>). Does land use at the production or the
attraction end of the trip affect the mode choice problem more? Is it different
by mode?</p>
</div>
<div id="second-problem-set-nested-logit-models" class="section level3 unnumbered">
<h3>Second Problem Set: Nested Logit Models</h3>
<p>In this set of problems, you will estimate nested logit models. To specify
nests in an <code>mlogit</code> estimation, you supply a list of alternatives to the <code>nests</code>
argument. The code below puts all auto-based alternatives in one nest called
<code>auto</code> and the other alternatives into another nest called <code>nonauto</code>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="chap-modechoice.html#cb100-1" aria-hidden="true" tabindex="-1"></a>nl <span class="ot">&lt;-</span> <span class="fu">mlogit</span>(CHOSEN <span class="sc">~</span> COST <span class="sc">+</span> TVTT  <span class="sc">+</span> OVTT <span class="sc">|</span> WKEMPDEN,  <span class="at">data =</span> worktrips,</span>
<span id="cb100-2"><a href="chap-modechoice.html#cb100-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">nests =</span> <span class="fu">list</span>(<span class="at">auto =</span> <span class="fu">c</span>(<span class="st">&#39;Drive Alone&#39;</span>, <span class="st">&#39;Share 2&#39;</span>, <span class="st">&#39;Share 3+&#39;</span>),</span>
<span id="cb100-3"><a href="chap-modechoice.html#cb100-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nonauto =</span> <span class="fu">c</span>(<span class="st">&#39;Bike&#39;</span>, <span class="st">&#39;Walk&#39;</span>, <span class="st">&#39;Transit&#39;</span>))</span></code></pre></div>
<p>Question 5: Estimate a nested logit model including cost, travel time,
out-of-vehicle travel time, and workplace employment density. Group car
alternatives into one nest, and non-car alternatives into another. Constrain the
nesting parameter to a single value (set the parameter <code>un.nest.el = TRUE</code>).
What is the estimated value of the nesting parameter? What are the implications
of this parameter value for across-nest substitution?</p>
<p>Question 6: Estimate another nested logit model with the same nests, but this
time segment the data on income; include households making less than $50k/year
in one segment and households making at least $50k in the other. Add vehicles
per worker as a covariate (<code>VEHBYWRK</code>). Comment on how the two segments respond
to the different covariates. Which matters more to which group?</p>
<p>Question 7. Of all the models you estimated (including in the previous segment),
which is the preferred in terms of model likelihood? What about in terms of
behavioral sensitivity / reasonableness?</p>
</div>
<div id="third-problem-set-log-sums-and-destination-choice" class="section level3 unnumbered">
<h3>Third Problem Set: Log Sums and Destination Choice</h3>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Mode Choice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept) × Share 2</td>
<td align="left">-2.405</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.063)</td>
</tr>
<tr class="odd">
<td align="left">(Intercept) × Share 3++</td>
<td align="left">-3.863</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.107)</td>
</tr>
<tr class="odd">
<td align="left">(Intercept) × Transit</td>
<td align="left">-1.535</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.134)</td>
</tr>
<tr class="odd">
<td align="left">(Intercept) × Bike</td>
<td align="left">-3.595</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.187)</td>
</tr>
<tr class="odd">
<td align="left">(Intercept) × Walk</td>
<td align="left">-2.598</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.105)</td>
</tr>
<tr class="odd">
<td align="left">IVTT</td>
<td align="left">-0.006</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.006)</td>
</tr>
<tr class="odd">
<td align="left">OVTT</td>
<td align="left">-0.052</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.006)</td>
</tr>
<tr class="odd">
<td align="left">COST</td>
<td align="left">-0.003</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.000)</td>
</tr>
<tr class="odd">
<td align="left">WKEMPDEN × Share 2</td>
<td align="left">0.001</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.000)</td>
</tr>
<tr class="odd">
<td align="left">WKEMPDEN × Share 3++</td>
<td align="left">0.002</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.000)</td>
</tr>
<tr class="odd">
<td align="left">WKEMPDEN × Transit</td>
<td align="left">0.003</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.000)</td>
</tr>
<tr class="odd">
<td align="left">WKEMPDEN × Bike</td>
<td align="left">0.001</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.001)</td>
</tr>
<tr class="odd">
<td align="left">WKEMPDEN × Walk</td>
<td align="left">0.002</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">(0.001)</td>
</tr>
<tr class="odd">
<td align="left">Num.Obs.</td>
<td align="left">5029</td>
</tr>
<tr class="even">
<td align="left">AIC</td>
<td align="left">7329.0</td>
</tr>
<tr class="odd">
<td align="left">BIC</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Log.Lik.</td>
<td align="left">-3651.489</td>
</tr>
<tr class="odd">
<td align="left">rho2</td>
<td align="left">0.248</td>
</tr>
<tr class="even">
<td align="left">rho20</td>
<td align="left">0.595</td>
</tr>
</tbody>
</table>
<p>Question 8. An MNL mode choice model is given above. Calculate the utility,
choice probabilities, and the choice model logsum for the individual in the
dataset below.</p>
<table>
<thead>
<tr class="header">
<th align="right">IVTT</th>
<th align="right">OVTT</th>
<th align="right">COST</th>
<th align="right">WKEMPDEN</th>
<th align="left">alternative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">13.4</td>
<td align="right">2</td>
<td align="right">70.6</td>
<td align="right">3.48</td>
<td align="left">Drive Alone</td>
</tr>
<tr class="even">
<td align="right">18.4</td>
<td align="right">2</td>
<td align="right">35.3</td>
<td align="right">3.48</td>
<td align="left">Share 2</td>
</tr>
<tr class="odd">
<td align="right">20.4</td>
<td align="right">2</td>
<td align="right">20.2</td>
<td align="right">3.48</td>
<td align="left">Share 3+</td>
</tr>
<tr class="even">
<td align="right">25.9</td>
<td align="right">15.2</td>
<td align="right">116.</td>
<td align="right">3.48</td>
<td align="left">Transit</td>
</tr>
<tr class="odd">
<td align="right">40.5</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">3.48</td>
<td align="left">Bike</td>
</tr>
</tbody>
</table>
<p>Question 9 The same person is choosing which of two destinations to travel to.
The travel times to Zone 1 are given in question 8, and the travel times to Zone
2 are given below. The destination choice utility equation is
<span class="math inline">\(V_j = 0.35 * \text{MCLS}_{ij} + 2.56 * \ln(\text{office}_j) + 1.45 * ln(\text{service}_j)\)</span>.</p>
<table>
<thead>
<tr class="header">
<th align="right">IVTT</th>
<th align="right">OVTT</th>
<th align="right">COST</th>
<th align="right">WKEMPDEN</th>
<th align="left">alternative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">29.92</td>
<td align="right">10.0</td>
<td align="right">390.81</td>
<td align="right">764.19</td>
<td align="left">Drive Alone</td>
</tr>
<tr class="even">
<td align="right">34.92</td>
<td align="right">10.0</td>
<td align="right">195.40</td>
<td align="right">764.19</td>
<td align="left">Share 2</td>
</tr>
<tr class="odd">
<td align="right">21.92</td>
<td align="right">10.0</td>
<td align="right">97.97</td>
<td align="right">764.19</td>
<td align="left">Share 3+</td>
</tr>
<tr class="even">
<td align="right">22.96</td>
<td align="right">14.2</td>
<td align="right">185.00</td>
<td align="right">764.19</td>
<td align="left">Transit</td>
</tr>
<tr class="odd">
<td align="right">58.95</td>
<td align="right">10.0</td>
<td align="right">0.00</td>
<td align="right">764.19</td>
<td align="left">Bike</td>
</tr>
</tbody>
</table>
<p>The socioeconomic data for both zones is given below. Calculate the destination
utilities, choice probabilities, and the destination choice logsum.</p>
<table>
<thead>
<tr class="header">
<th align="right">TAZ</th>
<th align="right">office</th>
<th align="right">service</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">126</td>
<td align="right">742</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">321</td>
<td align="right">140</td>
</tr>
</tbody>
</table>
<p>Question 10. An improvement to the transit system is proposed that will lower the
above individual’s transit out-of-vehicle time to zone 1 to 5 minutes (from 15.2). Calculate
the mode choice utility, probabilities, and the mode choice model logsum. What
is the monetary value of this transit improvement to the mode choice of this person?</p>
<p>Question 11. Using the same improvement, calculate the destination choice utility,
probabilities, and destination choice logsum. What is the monetary value of the transit
improvement to the destination choice? Does this include the mode choice benefit?</p>
</div>
</div>
<div id="lab" class="section level2 unnumbered">
<h2>Lab</h2>
<p>In practice, small-sample surveys have a difficult time generating estimates of
choice parameters that are both precise and rational. As a result, it is
common to assert choice coefficients that have worked well in comparable
cities and then calibrate the mode-specific constants and distance decay
parameters to match your targets. In this lab you will calibrate the mode choice
models and the destination choice models for the following trip purposes:</p>
<ul>
<li>Home-based Work</li>
<li>Home-based Other</li>
<li>Home-based Shopping</li>
</ul>
<p>In the Roanoke mode choice model, HBO and HBShopping get combined for mode choice.
So you will calibrate three purposes in the destination choice model, but only
two in the mode choice model.</p>
<p>Even though trip distribution comes first in the standard four-step process, we
end up using the mode choice logsums mode choice to inform destination choice.
Mathematically they happen simultaneously, but in the model it goes</p>
<pre><code>skims &gt; mode choice logsums &gt; destination choice &gt; mode choice</code></pre>
<p>As a result you will need to calibrate the models iteratively: first adjust the
mode choice constants, then the distance decay parameters, then mode choice,
etc., until you are satisfied that the model meets the targets.</p>
<div id="mode-choice-calibration" class="section level3 unnumbered">
<h3>Mode Choice Calibration</h3>
<p>The coefficients are found in the <code>./Params/mc/MC_Coefficients.csv</code> file. Record
the coefficients in a table in your lab report accompanying a description of the
purpose of each coefficient and any notable values. These coefficients are
fixed; they should not change as part of this exercise.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="chap-modechoice.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">&quot;data/rvtpo_data/MC_Coefficients.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="chap-modechoice.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="chap-modechoice.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<pre><code>## Rows: 20 Columns: 6</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (1): Name
## dbl (5): ;N, HBW, HBO, NHB, HBSC</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
;N
</th>
<th style="text-align:left;">
Name
</th>
<th style="text-align:right;">
HBW
</th>
<th style="text-align:right;">
HBO
</th>
<th style="text-align:right;">
NHB
</th>
<th style="text-align:right;">
HBSC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
CIVTT
</td>
<td style="text-align:right;">
-0.02500
</td>
<td style="text-align:right;">
-0.01500
</td>
<td style="text-align:right;">
-0.02000
</td>
<td style="text-align:right;">
-0.01500
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
CSWAIT
</td>
<td style="text-align:right;">
-0.05625
</td>
<td style="text-align:right;">
-0.03375
</td>
<td style="text-align:right;">
-0.04500
</td>
<td style="text-align:right;">
-0.03375
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
CLWAIT
</td>
<td style="text-align:right;">
-0.02500
</td>
<td style="text-align:right;">
-0.01500
</td>
<td style="text-align:right;">
-0.02000
</td>
<td style="text-align:right;">
-0.01500
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
CXWAIT
</td>
<td style="text-align:right;">
-0.06250
</td>
<td style="text-align:right;">
-0.03750
</td>
<td style="text-align:right;">
-0.05000
</td>
<td style="text-align:right;">
-0.03750
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
CCOST
</td>
<td style="text-align:right;">
-0.00158
</td>
<td style="text-align:right;">
-0.00237
</td>
<td style="text-align:right;">
-0.00253
</td>
<td style="text-align:right;">
-0.18000
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
CDRIVE
</td>
<td style="text-align:right;">
-0.05625
</td>
<td style="text-align:right;">
-0.03375
</td>
<td style="text-align:right;">
-0.04500
</td>
<td style="text-align:right;">
-0.03375
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
CTERML
</td>
<td style="text-align:right;">
-0.06250
</td>
<td style="text-align:right;">
-0.03750
</td>
<td style="text-align:right;">
-0.05000
</td>
<td style="text-align:right;">
-0.06250
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
CWALK
</td>
<td style="text-align:right;">
-0.06250
</td>
<td style="text-align:right;">
-0.03750
</td>
<td style="text-align:right;">
-0.05000
</td>
<td style="text-align:right;">
-0.03750
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
CWALK1
</td>
<td style="text-align:right;">
-0.06250
</td>
<td style="text-align:right;">
-0.03750
</td>
<td style="text-align:right;">
-0.05000
</td>
<td style="text-align:right;">
-0.03750
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
CWALK2
</td>
<td style="text-align:right;">
-0.09375
</td>
<td style="text-align:right;">
-0.05625
</td>
<td style="text-align:right;">
-0.07500
</td>
<td style="text-align:right;">
-0.05625
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
CBIKE1
</td>
<td style="text-align:right;">
-0.06250
</td>
<td style="text-align:right;">
-0.03750
</td>
<td style="text-align:right;">
-0.05000
</td>
<td style="text-align:right;">
-0.03750
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
CBIKE2
</td>
<td style="text-align:right;">
-0.09375
</td>
<td style="text-align:right;">
-0.05625
</td>
<td style="text-align:right;">
-0.07500
</td>
<td style="text-align:right;">
-0.05625
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
DWalkBIKE
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
1.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
NC1
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.50000
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
NC2
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.50000
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
NC3
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.50000
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
CBD
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
NXFER
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
AUTOCOST
</td>
<td style="text-align:right;">
13.60000
</td>
<td style="text-align:right;">
13.60000
</td>
<td style="text-align:right;">
13.60000
</td>
<td style="text-align:right;">
13.60000
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
SHAREFAC
</td>
<td style="text-align:right;">
2.00000
</td>
<td style="text-align:right;">
2.00000
</td>
<td style="text-align:right;">
2.00000
</td>
<td style="text-align:right;">
2.00000
</td>
</tr>
</tbody>
</table>
<p>The mode-specific constants are in a separate file, <code>./Params/mc/MC_Constants.csv</code>.
The reference alternative in the choice model is Drive Alone, and the alternatives
with their nesting structure are:</p>
<pre><code>Trips
|-- Auto
|   |--Drive
|   |--Share
|
|-- Transit
|   |--Local
|   |--Premium
|
|-- Non-motorized</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="chap-modechoice.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">&quot;data/rvtpo_data/MC_Constants.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="chap-modechoice.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="chap-modechoice.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span></code></pre></div>
<pre><code>## Rows: 10 Columns: 6</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (1): Name
## dbl (5): ;N, HBW, HBO, NHB, HBSC</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
;N
</th>
<th style="text-align:left;">
Name
</th>
<th style="text-align:right;">
HBW
</th>
<th style="text-align:right;">
HBO
</th>
<th style="text-align:right;">
NHB
</th>
<th style="text-align:right;">
HBSC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
K_SR
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0336
</td>
<td style="text-align:right;">
-1.1685
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
K_TRN
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-2.2714
</td>
<td style="text-align:right;">
0.3261
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
K_NMOT
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.8655
</td>
<td style="text-align:right;">
-1.2505
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
K_PREM
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
</tbody>
</table>
<p>There is currently no premium service in the model, so changing its constant
will not result in more people taking it. But the structure for it exists, if the
MPO wants to look at some future transit options.</p>
<p>For initial values for the alternative-specific constants, you can use
parameters you estimated in the homework. After you run the destination choice
model and adjust its calibration (see below), run the mode choice model and look
at the mode choice report. Calculate new alternative specific constants using the
bias adjustment formula,</p>
<p><span class="math display">\[\alpha_{n+1} = \alpha_n + \log(A_j / S_j) \]</span></p>
<p>Where <span class="math inline">\(A_j\)</span> is the population share (target) and <span class="math inline">\(S_j\)</span> is the model share.
The population shares (targets) are given below.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="chap-modechoice.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Population shares (targets)</span></span>
<span id="cb111-2"><a href="chap-modechoice.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_xlsx</span>(<span class="st">&quot;data/rvtpo_data/mc.xlsx&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="chap-modechoice.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Mode</th>
<th align="right">HBW</th>
<th align="right">HBO</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Drive Alone</td>
<td align="right">87.5</td>
<td align="right">44.1</td>
</tr>
<tr class="even">
<td align="left">Share</td>
<td align="right">8.4</td>
<td align="right">45.5</td>
</tr>
<tr class="odd">
<td align="left">Local Bus</td>
<td align="right">2.7</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">Premium</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
</tr>
<tr class="odd">
<td align="left">Non-motorized</td>
<td align="right">1.4</td>
<td align="right">9.9</td>
</tr>
</tbody>
</table>
</div>
<div id="destination-choice-calibration" class="section level3 unnumbered">
<h3>Destination Choice Calibration</h3>
<p>A destination choice model has three basic components:</p>
<ul>
<li>A size term: these are the trip attraction rates</li>
<li>An impedance term: this is the mode choice logsum</li>
<li>Calibration constants</li>
</ul>
<p>Return to your trip generation lab where you estimated and adjusted attraction
rates for different land uses. These attraction rates are the size terms of the
destination choice model; replace the dummy rates in the model with your
estimated rates.</p>
<p>The coefficient on the logsum term should match the nesting parameter in the
mode choice model. This link is what allows for a simultaneous mode and
destination choice.</p>
<p>Instead of alternative-specific constants, a destination choice model includes
calibration constants based on distance-decay functions. By adjusting these
parameters, we can make the modeled trip length frequency distribution match the
observed distribution. The roanoke model has three basic versions that can be combined
(but really don’t need to be)</p>
<ul>
<li>A distance polynomial (<span class="math inline">\(\beta_d d + \beta_{d2} d^2 + \beta_{d3} d^3\)</span>)</li>
<li>A logarithmic decay function (<span class="math inline">\(\beta_d \log(d)\)</span>)</li>
<li>A set of bins for trips within specific mile ranges, 0-1, 1-2, etc.</li>
</ul>
<p>There is also an intrazonal constant, which we can leave alone for this lab.
Remember that most of the work should be done by the logsum and the size term,
and that the constants shouldn’t generally violate basic travel behavior theory.
These constants are really just here to nudge the distribution in one direction
or another.</p>
<p>The table and figure below show the observed trip length frequency distributions
for the purposes you need to calibrate. An Excel file with the values is on
LearningSuite.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="chap-modechoice.html#cb112-1" aria-hidden="true" tabindex="-1"></a>tlfd <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;data/rvtpo_data/tlfd.xlsx&quot;</span>)</span>
<span id="cb112-2"><a href="chap-modechoice.html#cb112-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tlfd)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">HIGH</th>
<th align="right">MID</th>
<th align="right">LOW</th>
<th align="right">HBW</th>
<th align="right">HBO</th>
<th align="right">HBSH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.5</td>
<td align="right">0</td>
<td align="right">3.9039039</td>
<td align="right">19.6131359</td>
<td align="right">13.9606519</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1.5</td>
<td align="right">1</td>
<td align="right">5.0050050</td>
<td align="right">7.9734108</td>
<td align="right">10.0849391</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2.5</td>
<td align="right">2</td>
<td align="right">8.3083083</td>
<td align="right">11.9601161</td>
<td align="right">23.5531056</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">3.5</td>
<td align="right">3</td>
<td align="right">10.0100100</td>
<td align="right">12.9567925</td>
<td align="right">13.8690052</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">4.5</td>
<td align="right">4</td>
<td align="right">10.3103103</td>
<td align="right">8.9700871</td>
<td align="right">8.5542211</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">5.5</td>
<td align="right">5</td>
<td align="right">9.0090090</td>
<td align="right">6.9767344</td>
<td align="right">7.1484507</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">6.5</td>
<td align="right">6</td>
<td align="right">13.0130130</td>
<td align="right">7.5098897</td>
<td align="right">6.7094465</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">7.5</td>
<td align="right">7</td>
<td align="right">9.5095095</td>
<td align="right">4.7840465</td>
<td align="right">4.3326161</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">8.5</td>
<td align="right">8</td>
<td align="right">7.6076076</td>
<td align="right">5.0830494</td>
<td align="right">2.8884107</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">9.5</td>
<td align="right">9</td>
<td align="right">5.8058058</td>
<td align="right">4.9833817</td>
<td align="right">3.0809714</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">10.5</td>
<td align="right">10</td>
<td align="right">4.2042042</td>
<td align="right">4.0863730</td>
<td align="right">2.4070089</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">11.5</td>
<td align="right">11</td>
<td align="right">2.0020020</td>
<td align="right">1.7940174</td>
<td align="right">0.4464608</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">12.5</td>
<td align="right">12</td>
<td align="right">1.9019019</td>
<td align="right">1.8936851</td>
<td align="right">2.2144482</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">13.5</td>
<td align="right">13</td>
<td align="right">3.0030030</td>
<td align="right">0.3986705</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">14.5</td>
<td align="right">14</td>
<td align="right">1.9019019</td>
<td align="right">0.6976734</td>
<td align="right">0.3851214</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">15.5</td>
<td align="right">15</td>
<td align="right">0.5005005</td>
<td align="right">0.0996676</td>
<td align="right">0.1093873</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">16.5</td>
<td align="right">16</td>
<td align="right">1.0010010</td>
<td align="right">0.0897009</td>
<td align="right">0.0772576</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">17.5</td>
<td align="right">17</td>
<td align="right">0.3003003</td>
<td align="right">0.0797341</td>
<td align="right">0.0590860</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">18.5</td>
<td align="right">18</td>
<td align="right">0.8008008</td>
<td align="right">0.0000000</td>
<td align="right">0.0402657</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">19.5</td>
<td align="right">19</td>
<td align="right">0.0000000</td>
<td align="right">0.0498338</td>
<td align="right">0.0304333</td>
</tr>
<tr class="odd">
<td align="right">21</td>
<td align="right">20.5</td>
<td align="right">20</td>
<td align="right">1.0010010</td>
<td align="right">0.0000000</td>
<td align="right">0.0210982</td>
</tr>
<tr class="even">
<td align="right">22</td>
<td align="right">21.5</td>
<td align="right">21</td>
<td align="right">0.9009009</td>
<td align="right">0.0000000</td>
<td align="right">0.0276142</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="chap-modechoice.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tlfd <span class="sc">%&gt;%</span> <span class="fu">gather</span>(purpose, share, HBW<span class="sc">:</span>HBSH), </span>
<span id="cb113-2"><a href="chap-modechoice.html#cb113-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> LOW, <span class="at">y =</span> share, <span class="at">color =</span> purpose)) <span class="sc">+</span></span>
<span id="cb113-3"><a href="chap-modechoice.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb113-4"><a href="chap-modechoice.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Distance&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;%Trips&quot;</span>)</span></code></pre></div>
<p><img src="04_modechoice_files/figure-html/tfld-plot-1.png" width="672" /></p>
<p>The modeled TLFD for each purpose can be had on the model home screen as an
output of the trip distribution model. Calculate the error between your observed
and modeled TLFD. Determine which calibration curve you will use (you may decide
to use different curves for different purposes). Find the coefficients of the
curve that will compensate for the error in the model.</p>
<p>Re-run the destination choice model with your new coefficients, run the mode choice
model, and adjust the coefficients over there.</p>
</div>
<div id="report-2" class="section level3 unnumbered">
<h3>Report</h3>
<p>Your lab report should describe the trip distribution and mode choice models;
include discussions of the coefficients and your process to calibrate the mode
and distance constants. Provide results of the calibration including observed and
modeled mode choice and trip length frequency distributions.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>Specifically, that <span class="math inline">\(\varepsilon_i\)</span> is distributed IID with a Gumbel extreme value distribution<a href="chap-modechoice.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>You can estimate linear
regression models with maximum likelihood estimation as well, but it can be
proven the MLE and OLS result in exactly the same answers.<a href="chap-modechoice.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap-distribution.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-assignment.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ceen565.pdf", "ceen565.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
