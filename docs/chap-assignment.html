<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Network Assignment and Validation | Urban Transportation Planning</title>
  <meta name="description" content="These are notes and assignments related to the Urban Transportation Planning class at BYU." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Network Assignment and Validation | Urban Transportation Planning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are notes and assignments related to the Urban Transportation Planning class at BYU." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Network Assignment and Validation | Urban Transportation Planning" />
  
  <meta name="twitter:description" content="These are notes and assignments related to the Urban Transportation Planning class at BYU." />
  

<meta name="author" content="Gregory Macfarlane, PhD, PE" />


<meta name="date" content="2021-10-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap-modechoice.html"/>
<link rel="next" href="chap-process.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Urban Transportation Planning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Foreword</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap-blocks.html"><a href="chap-blocks.html"><i class="fa fa-check"></i><b>1</b> Building Blocks</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chap-blocks.html"><a href="chap-blocks.html#planning-for-human-systems"><i class="fa fa-check"></i><b>1.1</b> Planning for Human Systems</a></li>
<li class="chapter" data-level="1.2" data-path="chap-blocks.html"><a href="chap-blocks.html#the-four-step-transportation-planning-process"><i class="fa fa-check"></i><b>1.2</b> The Four-Step Transportation Planning Process</a></li>
<li class="chapter" data-level="1.3" data-path="chap-blocks.html"><a href="chap-blocks.html#travel-model-building-blocks"><i class="fa fa-check"></i><b>1.3</b> Travel Model Building Blocks</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="chap-blocks.html"><a href="chap-blocks.html#travel-analysis-zones-and-se-data"><i class="fa fa-check"></i><b>1.3.1</b> Travel Analysis Zones and SE Data</a></li>
<li class="chapter" data-level="1.3.2" data-path="chap-blocks.html"><a href="chap-blocks.html#transportation-networks"><i class="fa fa-check"></i><b>1.3.2</b> Transportation Networks</a></li>
<li class="chapter" data-level="1.3.3" data-path="chap-blocks.html"><a href="chap-blocks.html#matrices"><i class="fa fa-check"></i><b>1.3.3</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chap-blocks.html"><a href="chap-blocks.html#data-inputs"><i class="fa fa-check"></i><b>1.4</b> Data Inputs</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="chap-blocks.html"><a href="chap-blocks.html#household-travel-surveys"><i class="fa fa-check"></i><b>1.4.1</b> Household Travel Surveys</a></li>
<li class="chapter" data-level="1.4.2" data-path="chap-blocks.html"><a href="chap-blocks.html#us-census-bureau"><i class="fa fa-check"></i><b>1.4.2</b> US Census Bureau</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="chap-blocks.html"><a href="chap-blocks.html#statistical-and-mathematical-techniques"><i class="fa fa-check"></i><b>1.5</b> Statistical and Mathematical Techniques</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="chap-blocks.html"><a href="chap-blocks.html#continuous-and-discrete-distributions"><i class="fa fa-check"></i><b>1.5.1</b> Continuous and Discrete Distributions</a></li>
<li class="chapter" data-level="1.5.2" data-path="chap-blocks.html"><a href="chap-blocks.html#ipf"><i class="fa fa-check"></i><b>1.5.2</b> Iterative Proportional Fitting</a></li>
<li class="chapter" data-level="1.5.3" data-path="chap-blocks.html"><a href="chap-blocks.html#regression-analysis"><i class="fa fa-check"></i><b>1.5.3</b> Regression Analysis</a></li>
<li class="chapter" data-level="1.5.4" data-path="chap-blocks.html"><a href="chap-blocks.html#numerical-optimization"><i class="fa fa-check"></i><b>1.5.4</b> Numerical Optimization</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chap-blocks.html"><a href="chap-blocks.html#hw-blocks"><i class="fa fa-check"></i>Homework</a></li>
<li class="chapter" data-level="" data-path="chap-blocks.html"><a href="chap-blocks.html#lab-blocks"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="chap-blocks.html"><a href="chap-blocks.html#marginal-distributions"><i class="fa fa-check"></i>Marginal Distributions</a></li>
<li class="chapter" data-level="" data-path="chap-blocks.html"><a href="chap-blocks.html#joint-distribution"><i class="fa fa-check"></i>Joint Distribution</a></li>
<li class="chapter" data-level="" data-path="chap-blocks.html"><a href="chap-blocks.html#report"><i class="fa fa-check"></i>Report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-tripgen.html"><a href="chap-tripgen.html"><i class="fa fa-check"></i><b>2</b> Trip Generation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap-tripgen.html"><a href="chap-tripgen.html#trip-production"><i class="fa fa-check"></i><b>2.1</b> Trip Production</a></li>
<li class="chapter" data-level="2.2" data-path="chap-tripgen.html"><a href="chap-tripgen.html#trip-attraction"><i class="fa fa-check"></i><b>2.2</b> Trip Attraction</a></li>
<li class="chapter" data-level="" data-path="chap-tripgen.html"><a href="chap-tripgen.html#hw-generation"><i class="fa fa-check"></i>Homework</a></li>
<li class="chapter" data-level="" data-path="chap-tripgen.html"><a href="chap-tripgen.html#lab-generation"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chap-tripgen.html"><a href="chap-tripgen.html#trip-production-1"><i class="fa fa-check"></i><b>2.2.1</b> Trip Production</a></li>
<li class="chapter" data-level="2.2.2" data-path="chap-tripgen.html"><a href="chap-tripgen.html#trip-attraction-1"><i class="fa fa-check"></i><b>2.2.2</b> Trip Attraction</a></li>
<li class="chapter" data-level="2.2.3" data-path="chap-tripgen.html"><a href="chap-tripgen.html#report-1"><i class="fa fa-check"></i><b>2.2.3</b> Report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-distribution.html"><a href="chap-distribution.html"><i class="fa fa-check"></i><b>3</b> Trip Distribution</a>
<ul>
<li class="chapter" data-level="" data-path="chap-distribution.html"><a href="chap-distribution.html#hw-distribution"><i class="fa fa-check"></i>Homework</a>
<ul>
<li class="chapter" data-level="" data-path="chap-distribution.html"><a href="chap-distribution.html#first-problem-gravity-model-development"><i class="fa fa-check"></i>First Problem: Gravity Model Development</a></li>
<li class="chapter" data-level="" data-path="chap-distribution.html"><a href="chap-distribution.html#second-problem-model-calibration"><i class="fa fa-check"></i>Second Problem: Model Calibration</a></li>
<li class="chapter" data-level="" data-path="chap-distribution.html"><a href="chap-distribution.html#third-problem-model-application"><i class="fa fa-check"></i>Third Problem: Model Application</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-modechoice.html"><a href="chap-modechoice.html"><i class="fa fa-check"></i><b>4</b> Mode and Destination Choice</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap-modechoice.html"><a href="chap-modechoice.html#mathematical-derivation"><i class="fa fa-check"></i><b>4.1</b> Mathematical Derivation</a></li>
<li class="chapter" data-level="4.2" data-path="chap-modechoice.html"><a href="chap-modechoice.html#utility-equations"><i class="fa fa-check"></i><b>4.2</b> Utility Equations</a></li>
<li class="chapter" data-level="4.3" data-path="chap-modechoice.html"><a href="chap-modechoice.html#mnl-estimation"><i class="fa fa-check"></i><b>4.3</b> MNL Estimation</a></li>
<li class="chapter" data-level="4.4" data-path="chap-modechoice.html"><a href="chap-modechoice.html#iia-and-nested-logit"><i class="fa fa-check"></i><b>4.4</b> IIA and Nested Logit</a></li>
<li class="chapter" data-level="4.5" data-path="chap-modechoice.html"><a href="chap-modechoice.html#accessibility-and-log-sums"><i class="fa fa-check"></i><b>4.5</b> Accessibility and Log Sums</a></li>
<li class="chapter" data-level="4.6" data-path="chap-modechoice.html"><a href="chap-modechoice.html#destination-choice"><i class="fa fa-check"></i><b>4.6</b> Destination Choice</a></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#hw-modechoice"><i class="fa fa-check"></i>Homework</a>
<ul>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#first-problem-set-multinomial-logit-model-estimation"><i class="fa fa-check"></i>First Problem Set: Multinomial Logit Model Estimation</a></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#second-problem-set-nested-logit-models"><i class="fa fa-check"></i>Second Problem Set: Nested Logit Models</a></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#third-problem-set-log-sums-and-destination-choice"><i class="fa fa-check"></i>Third Problem Set: Log Sums and Destination Choice</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#lab"><i class="fa fa-check"></i>Lab</a>
<ul>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#mode-choice-calibration"><i class="fa fa-check"></i>Mode Choice Calibration</a></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#destination-choice-calibration"><i class="fa fa-check"></i>Destination Choice Calibration</a></li>
<li class="chapter" data-level="" data-path="chap-modechoice.html"><a href="chap-modechoice.html#report-2"><i class="fa fa-check"></i>Report</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-assignment.html"><a href="chap-assignment.html"><i class="fa fa-check"></i><b>5</b> Network Assignment and Validation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap-assignment.html"><a href="chap-assignment.html#volume---delay-functions"><i class="fa fa-check"></i><b>5.1</b> Volume - Delay Functions</a></li>
<li class="chapter" data-level="5.2" data-path="chap-assignment.html"><a href="chap-assignment.html#assignment-algorithms"><i class="fa fa-check"></i><b>5.2</b> Assignment Algorithms</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chap-assignment.html"><a href="chap-assignment.html#all-or-nothing"><i class="fa fa-check"></i><b>5.2.1</b> All-or-Nothing</a></li>
<li class="chapter" data-level="5.2.2" data-path="chap-assignment.html"><a href="chap-assignment.html#incremental-assignment"><i class="fa fa-check"></i><b>5.2.2</b> Incremental Assignment</a></li>
<li class="chapter" data-level="5.2.3" data-path="chap-assignment.html"><a href="chap-assignment.html#successive-averages-fhwa-assignment"><i class="fa fa-check"></i><b>5.2.3</b> Successive Averages (FHWA) Assignment</a></li>
<li class="chapter" data-level="5.2.4" data-path="chap-assignment.html"><a href="chap-assignment.html#frank-wolfe"><i class="fa fa-check"></i><b>5.2.4</b> Frank-Wolfe</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chap-assignment.html"><a href="chap-assignment.html#hw-assignment"><i class="fa fa-check"></i>Homework</a></li>
<li class="chapter" data-level="" data-path="chap-assignment.html"><a href="chap-assignment.html#laboratory-assignment"><i class="fa fa-check"></i>Laboratory Assignment</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap-process.html"><a href="chap-process.html"><i class="fa fa-check"></i><b>6</b> The Planning Process</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="app-demomodel.html"><a href="app-demomodel.html"><i class="fa fa-check"></i><b>A</b> Demonstration Model</a>
<ul>
<li class="chapter" data-level="A.1" data-path="app-demomodel.html"><a href="app-demomodel.html#running-the-model"><i class="fa fa-check"></i><b>A.1</b> Running the Model</a></li>
<li class="chapter" data-level="A.2" data-path="app-demomodel.html"><a href="app-demomodel.html#files-and-reports"><i class="fa fa-check"></i><b>A.2</b> Files and Reports</a></li>
<li class="chapter" data-level="A.3" data-path="app-demomodel.html"><a href="app-demomodel.html#writing-custom-scripts"><i class="fa fa-check"></i><b>A.3</b> Writing Custom Scripts</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="app-demomodel.html"><a href="app-demomodel.html#network-bandwidth"><i class="fa fa-check"></i><b>A.3.1</b> Network Bandwidth</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="app-demomodel.html"><a href="app-demomodel.html#network-and-zone-maps"><i class="fa fa-check"></i><b>A.4</b> Network and Zone Maps</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="app-demomodel.html"><a href="app-demomodel.html#shortest-paths"><i class="fa fa-check"></i><b>A.4.1</b> Shortest Paths</a></li>
<li class="chapter" data-level="A.4.2" data-path="app-demomodel.html"><a href="app-demomodel.html#mode-choice-logsum-maps"><i class="fa fa-check"></i><b>A.4.2</b> Mode Choice Logsum Maps</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="app-demomodel.html"><a href="app-demomodel.html#editing-transit-lines"><i class="fa fa-check"></i><b>A.5</b> Editing Transit Lines</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="app-rstudio.html"><a href="app-rstudio.html"><i class="fa fa-check"></i><b>B</b> R and RStudio Help</a>
<ul>
<li class="chapter" data-level="B.1" data-path="app-rstudio.html"><a href="app-rstudio.html#installing"><i class="fa fa-check"></i><b>B.1</b> Installing</a></li>
<li class="chapter" data-level="B.2" data-path="app-rstudio.html"><a href="app-rstudio.html#rstudio-orientation"><i class="fa fa-check"></i><b>B.2</b> RStudio Orientation</a></li>
<li class="chapter" data-level="B.3" data-path="app-rstudio.html"><a href="app-rstudio.html#r-packages"><i class="fa fa-check"></i><b>B.3</b> R Packages</a></li>
<li class="chapter" data-level="B.4" data-path="app-rstudio.html"><a href="app-rstudio.html#working-with-tables"><i class="fa fa-check"></i><b>B.4</b> Working with Tables</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="app-rstudio.html"><a href="app-rstudio.html#reading-data"><i class="fa fa-check"></i><b>B.4.1</b> Reading Data</a></li>
<li class="chapter" data-level="B.4.2" data-path="app-rstudio.html"><a href="app-rstudio.html#modifying-and-summarizing-tables"><i class="fa fa-check"></i><b>B.4.2</b> Modifying and Summarizing Tables</a></li>
<li class="chapter" data-level="B.4.3" data-path="app-rstudio.html"><a href="app-rstudio.html#app-mutate"><i class="fa fa-check"></i><b>B.4.3</b> Mutate, Summarize, and Group</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="app-rstudio.html"><a href="app-rstudio.html#graphics-with-ggplot2"><i class="fa fa-check"></i><b>B.5</b> Graphics with <code>ggplot2</code></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Urban Transportation Planning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap-assignment" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Network Assignment and Validation</h1>
<p>The purpose of network assignment is to estimate the traffic flows that will
occur on each highway link, given the highway network and the trips flowing
from all origins to all destinations (determined by the other three
steps of the four-step model).</p>
<p>On average, we start from the assumption that people will take the shortest path
available to them. The travel time on a particular road is a function of the
road’s capacity as well as its volume. Because the volume is not known when we
start a traffic assignment process, we will have to find the solution iteratively.</p>
<div id="volume---delay-functions" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Volume - Delay Functions</h2>
<p>A volume-delay function (VDF) calculates the increase of travel time on a
roadway based on the ratio of volume <span class="math inline">\(V\)</span> to capacity <span class="math inline">\(C\)</span>. A popular equation in
travel modeling is a function developed by the Buruea of Public Roads (the
predecessor to the US Department of Transportation). The BPR VDF is</p>
<p><span class="math display" id="eq:bpr-vdf">\[\begin{equation}
  t = t_0[1 + \alpha * (V/C)^\beta] 
  \tag{5.1}
\end{equation}\]</span></p>
<p>Where <span class="math inline">\(t\)</span> is the travel time on the link, <span class="math inline">\(t_0\)</span> is the base travel time,
and <span class="math inline">\(\alpha, \beta\)</span> are calibrated parameters. Figure <a href="chap-assignment.html#fig:bpr-coeffs">5.1</a>
shows average values for BPR functions obtained from a sample of MPO travel models
of different sizes. As roads become more heavily loaded, the travel time increases
and other routes become more attractive.</p>
<div class="figure"><span style="display:block;" id="fig:bpr-coeffs"></span>
<img src="05_assignment_files/figure-html/bpr-coeffs-1.png" alt="Average BPR VDF curves in a sample of MPO models." width="672" />
<p class="caption">
Figure 5.1: Average BPR VDF curves in a sample of MPO models.
</p>
</div>
</div>
<div id="assignment-algorithms" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Assignment Algorithms</h2>
<p>Consider that we have the network below, with two routes between nodes <span class="math inline">\(A\)</span> and
<span class="math inline">\(B\)</span>. The bypass is longer initially, but its travel time will grow less quickly
with added volume.</p>
<p><img src="05_assignment_files/figure-html/unnamed-chunk-1-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>In general, the operating theory of network assignment is called
<em>static user equilibrium</em>,</p>
<blockquote>
<p>A network is in static user equilibrium if a person cannot find a shorter path
between their origin and destination. That is, all paths that are used have the
same travel cost, and all longer paths are unused.</p>
</blockquote>
<p>In a small and simple network, we could just generate a system of equations that
represent the SUE conditions, and solve for the values that will give us that
loading. In our example, we can write the system of equations as</p>
<p><span class="math display">\[\begin{align*}
    &amp;   t_b &amp;- 0.005 V_b  &amp;           &amp;= 15 \\
t_t &amp;       &amp;             &amp;- 0.02 V_t &amp;= 10 \\
t_t &amp; - t_b &amp;             &amp;           &amp;= 0\\
    &amp;       &amp;       V_b   &amp; + V_t     &amp;= 1000\\
\end{align*}\]</span></p>
<p>We can solve this using our matrix calculation skills from linear algebra. The
SUE assignment is reached when 600 vehicles take the bypass and 400 vehicles take
the through road, because when that happens both the routes have an equal
travel time of 18 minutes.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="chap-assignment.html#cb114-1" aria-hidden="true" tabindex="-1"></a>(A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.005</span>, <span class="dv">0</span>, </span>
<span id="cb114-2"><a href="chap-assignment.html#cb114-2" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.02</span>, </span>
<span id="cb114-3"><a href="chap-assignment.html#cb114-3" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb114-4"><a href="chap-assignment.html#cb114-4" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">ncol =</span> <span class="dv">4</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2]   [,3]  [,4]
## [1,]    0    1 -0.005  0.00
## [2,]    1    0  0.000 -0.02
## [3,]    1   -1  0.000  0.00
## [4,]    0    0  1.000  1.00</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="chap-assignment.html#cb116-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1000</span>)</span>
<span id="cb116-2"><a href="chap-assignment.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ax = b -&gt; x = A^-1 b</span></span>
<span id="cb116-3"><a href="chap-assignment.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(A) <span class="sc">%*%</span> b</span></code></pre></div>
<pre><code>##      [,1]
## [1,]   18
## [2,]   18
## [3,]  600
## [4,]  400</code></pre>
<p>It is not going to be feasible to construct this UE matrix for more complex networks.
So engineers have developed heuristic algorithms that iterate to find
a solution that replicates the UE conditions.</p>
<div id="all-or-nothing" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> All-or-Nothing</h3>
<p>The most basic way to assign trips is with an “all-or-nothing” (AON) assignment.
This simply puts all the trips between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> on the shortest route. This
is obviously not great in a lot of ways, because it will overload some
roads while leaving other roads completely empty. So if we assign 1000 trips to
this network, the volumes and travel times become</p>
<p><img src="05_assignment_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We could repeat this process many times, assigning new AON loads to the updated
travel times. This won’t converge to anything, but we could take the average of
all the different AON loadings and run with that. It’s not perfect, but it’s
easy.</p>
</div>
<div id="incremental-assignment" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Incremental Assignment</h3>
<p>Instead of assigning the flows all at once, we might be able to get a more
realistic loading by loading the flows in increments. Here’s how this algorithm
works:</p>
<ol style="list-style-type: decimal">
<li>Select increments <span class="math inline">\(p_n\)</span> that sum to 1 (e.g., 0.4, 0.3, 0.2, and 0.1)</li>
<li>Calculate the travel times on all links</li>
<li>Assign <span class="math inline">\(V_n * p_n\)</span> trips to the network via All-or-Nothing</li>
<li>Return to step 2 with the next increment</li>
</ol>
<p>Assigning the 1000 trips to our two-route network using the increment values
results in the following successive assignments.</p>
<table>
<thead>
<tr class="header">
<th>Iteration</th>
<th>Increment</th>
<th>Vb</th>
<th>tb</th>
<th>Vt</th>
<th>tt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td></td>
<td>0</td>
<td>15</td>
<td>0</td>
<td>10</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.4</td>
<td>0</td>
<td>15</td>
<td>400</td>
<td>18</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.3</td>
<td>300</td>
<td>16.5</td>
<td>400</td>
<td>18</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.2</td>
<td>500</td>
<td>17.5</td>
<td>400</td>
<td>18</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.1</td>
<td>600</td>
<td>18</td>
<td>400</td>
<td>18</td>
</tr>
</tbody>
</table>
</div>
<div id="successive-averages-fhwa-assignment" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Successive Averages (FHWA) Assignment</h3>
<p>A big problem with the AON assignment (and with incremental assignment) is the
large jump in travel times between iterations. It also is not guaranteed to
converge to any particular solution, and the outcome is determined by the
assumptions of the number of increments applied.</p>
<p>This can be improved with a method developed by FHWA that is designed to
repeatedly load the network and update the travel times by a diminishing rate.
In this method, the volume on any particular link after iteration is given by</p>
<p><span class="math display" id="eq:fhwa">\[\begin{equation}
  V_{n} = (1-\phi) * V_{n-1} + \phi F
  \tag{5.2}
\end{equation}\]</span></p>
<p>Where <span class="math inline">\(\phi = 1 / n\)</span> and F is the load of an All-or-Nothing assignment.
As <span class="math inline">\(n\)</span> increases, the relative amount of weight given to the previous assignment
increases relative to the new AON assignment. The following table shows ten iterations
of this algorithm.</p>
<table>
<thead>
<tr class="header">
<th>Iterations</th>
<th>Load</th>
<th>phi</th>
<th>Vt</th>
<th>tt</th>
<th>Vb</th>
<th>tb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>F</td>
<td>1</td>
<td>1000</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>V</td>
<td></td>
<td>1000</td>
<td>30</td>
<td></td>
<td>15</td>
</tr>
<tr class="odd">
<td>2</td>
<td>F</td>
<td>0.5</td>
<td></td>
<td></td>
<td>1000</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>V</td>
<td></td>
<td>500</td>
<td>20</td>
<td>500</td>
<td>17.5</td>
</tr>
<tr class="odd">
<td>3</td>
<td>F</td>
<td>0.33333333</td>
<td></td>
<td></td>
<td>1000</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>V</td>
<td></td>
<td>333.33</td>
<td>16.67</td>
<td>666.67</td>
<td>18.3333333</td>
</tr>
<tr class="odd">
<td>4</td>
<td>F</td>
<td>0.25</td>
<td>1000</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>V</td>
<td></td>
<td>500</td>
<td>20</td>
<td>500</td>
<td>17.5</td>
</tr>
<tr class="odd">
<td>5</td>
<td>F</td>
<td>0.2</td>
<td></td>
<td></td>
<td>1000</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>V</td>
<td></td>
<td>400</td>
<td>18</td>
<td>600</td>
<td>18</td>
</tr>
<tr class="odd">
<td>6</td>
<td>F</td>
<td>0.16666667</td>
<td>1000</td>
<td></td>
<td>0</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>V</td>
<td></td>
<td>500</td>
<td>20</td>
<td>500</td>
<td>17.5</td>
</tr>
<tr class="odd">
<td>7</td>
<td>F</td>
<td>0.14285714</td>
<td></td>
<td></td>
<td>1000</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>V</td>
<td></td>
<td>428.571429</td>
<td>18.5714286</td>
<td>571.428571</td>
<td>17.8571429</td>
</tr>
<tr class="odd">
<td>8</td>
<td>F</td>
<td>0.125</td>
<td></td>
<td>10</td>
<td>1000</td>
<td>20</td>
</tr>
<tr class="even">
<td></td>
<td>V</td>
<td></td>
<td>375</td>
<td>17.5</td>
<td>625</td>
<td>18.125</td>
</tr>
<tr class="odd">
<td>9</td>
<td>F</td>
<td>0.11111111</td>
<td>1000</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>V</td>
<td></td>
<td>444.44</td>
<td>18.89</td>
<td>555.56</td>
<td>17.78</td>
</tr>
<tr class="odd">
<td>10</td>
<td>F</td>
<td>0.1</td>
<td></td>
<td></td>
<td>1000</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>V</td>
<td></td>
<td>400.00</td>
<td>18.00</td>
<td>600.00</td>
<td>18.00</td>
</tr>
</tbody>
</table>
</div>
<div id="frank-wolfe" class="section level3" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Frank-Wolfe</h3>
<p>We can represent SUE traffic assignment as a nonlinear optimization problem. Let</p>
<ul>
<li><span class="math inline">\(v_a =\)</span> vehicles assigned to link <span class="math inline">\(a\)</span>.</li>
<li><span class="math inline">\(S_a(v_a) =\)</span> the travel cost on link <span class="math inline">\(a\)</span> as a function of its volume (VDF function)</li>
<li><span class="math inline">\(X_{ij}^r =\)</span> the total number of vehicles traveling from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> on
the sum of links that represent route <span class="math inline">\(r\)</span>.</li>
</ul>
<p>We want to minimize the total travel cost</p>
<p><span class="math display" id="eq:fw-objective">\[\begin{equation}
  \sum_a \int_0^{v_a} S_a(x) dx
  \tag{5.3}
\end{equation}\]</span></p>
<p>subject to the constraints</p>
<p><span class="math display">\[\begin{align*}
  v_a &amp;= \sum_i \sum_j \sum_r \delta_{ij}^{ar}X_{ij}{r}\\
  \sum_r X_{ij}^r &amp;= T_{ij}\\
  X_{ij}^r &amp;\geq 0 
\end{align*}\]</span></p>
<p>In text, the constraints are as follow: the volume on a link is a
sum of the volume on all routes that use that link (<span class="math inline">\(\delta\)</span> is indicator), the
total of all routes has to equal the total number of trips assigned, and the
paths on a route are not allowed to be negative.</p>
<p>Various algorithms can be used to find the values of <span class="math inline">\(v_a\)</span> that minimize this
objective function subject to these constraints. A popular algorithm is the
Frank-Wolfe algorithm, though other algorithms have been developed that converge
more quickly under different scenarios.</p>
<p>With these algorithms, it is essential to allow the algorithm to converge
appropriately. A measure of the convergence is a statistic called the “relative
gap,” or the difference between the assignment at that iteration and an AON
assignment made with the calculated travel times. As this gap becomes smaller,
it means that the difference between travel times on the routes are becoming
closer to each other. The figure below shows the value of the relative gap
after several thousand iterations in the Washington, D.C. travel model.</p>
<div class="figure"><span style="display:block;" id="fig:relative-gap"></span>
<img src="images/05_relativegap.png" alt="Relative gap after several thousand iterations." width="899" />
<p class="caption">
Figure 5.2: Relative gap after several thousand iterations.
</p>
</div>
<p>Large networks may take many hours to reach convergence that is acceptable for
policy analysis. There is a large incentive to “cut corners” by shrinking the
maximum number of iterations that are run, but this can lead to strange behavior.</p>
</div>
</div>
<div id="hw-assignment" class="section level2 unnumbered">
<h2>Homework</h2>
<div class="figure">
<img src="images/05_network.png" alt="" />
<p class="caption">Network</p>
</div>
<p>The figure above<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> represents a simple four-node
network where 7000 vehicles travel from A to D, and 5000 travel from B to D
(there are no additional trips from C to D). Link travel times for the network
are given by the functions below.</p>
<p><span class="math display">\[\begin{align*}
t_{AD} =&amp; 20 + 0.01 q_{AD}\\
t_{AC} =&amp; 10 + 0.005 q_{AC}\\
t_{CD} =&amp; 12 + 0.005 q_{CD}\\
t_{BC} =&amp; 7.25 + 0.005 q_{BC}\\
t_{BD} =&amp; 20 + 0.01 q_{BD}
\end{align*}\]</span></p>
<p>Question 1: Solve for the user equilibrium (UE) link flows and travel times by
solving a set of simultaneous equations that explicitly define the UE
conditions. Demonstrate that your solution is the user equilibrium by showing
through example that all UE conditions are satisfied.</p>
<p>Question 2: Perform four iterations of All Or Nothing (AON) assignment on the network
and O/D volumes. Show the link flows and travel times at the end of each
iteration and compute the average link loads and travel times.</p>
<p>Question 3: Perform four iterations of an incremental assignment assignment
using the increment values 0.4, 0.3, 0.2, and 0.1. Show the link flows and
travel times at the end of each iteration.</p>
<p>Question 4: Assign trips using the successive averages (FHWA) heuristic. Show
the link flows and travel times for five successive assignments, and the final
assignment.</p>
<p>Question 5: Compare these three traffic assignment heuristic approaches to the UE
assignment and to each other. How do the resulting flow patterns differ (cite
specific differences)? Which one comes closest to the UE flows?</p>
<p>Question 5: You are considering a road widening project in a suburb of a large
metropolitan area (indicated with the blue circle). The difference in loaded
volumes between your base scenario (no-build) and the widening is given in the figure
below. What is a likely explanation for the patterns shown in the figure?</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="images/05_convergence.png" alt="Difference in assigned volumes when adding a lane in area with blue circle." width="482" />
<p class="caption">
Figure 5.3: Difference in assigned volumes when adding a lane in area with blue circle.
</p>
</div>
</div>
<div id="laboratory-assignment" class="section level2 unnumbered">
<h2>Laboratory Assignment</h2>
<p>The highway volume-to-capacity curves in the Roanoke Model have already been
largely calibrated<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>. They use the Bureau of Public Roads (BPR) format,</p>
<p><span class="math display">\[T_c = T_0 * (1 + \alpha (V / C)^\beta)\]</span>
Create a plot showing the values of these curves for varying VOC ratios and
discuss the implications of the different curves on different facility types in
your report. Note that there are 5 facility types in the BPR table but 11
facility types in the model network. The assignment script files have comments
that build a crosswalk between the two facility type definitions.</p>
<p>For this lab, you will create a model validation report where you
examine the following:</p>
<ul>
<li>Root mean squared error (RMSE) by facility type, area type, volume group,
and by screenline. Are there certain classes that are outperforming others?</li>
<li>Observed vs Modeled link volume scatterplots: an X-Y fit
line by facility type as well as a maximum desirable deviation plot defined in
NCHRP 765.</li>
<li>Geographic distribution of link error.</li>
</ul>
<p>Comment on the Roanoke model’s calibration.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>This is an adaptation of a homework assignment from
Dr. John Ivan at the University of Connecticut.<a href="chap-assignment.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>To be specific, VDOT has values that they assert for all of
their models<a href="chap-assignment.html#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap-modechoice.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-process.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ceen565.pdf", "ceen565.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
